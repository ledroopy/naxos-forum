{% extends "base.html" %}
{% load static %}
{% block content %}
{# Path #}
<ol class="breadcrumb">
    <li><a href="{% url 'forum:top' %}">Accueil</a></li>
    <li class="active">{{ category.title }}</li>
</ol>
{# Buttons #}
<div class="row">
    <div style="padding: 10px 0">
        <a href="{% url 'forum:new_thread' category.slug %}">
            <button class="btn btn-default">Nouveau sujet</button></a>
        <a href="{% url 'forum:new_poll' category.slug %}">
            <button class="btn btn-default">Nouveau sondage</button></a>
    </div>
</div>
{# Threads #}
<div class="row">
    <table class="table table-condensed table-bordered" id="view">
        <thead>
        <tr>
            <th class="text-center" style="padding:5px 0;width:25px"><img src="{% static 'img/detail_search.gif' %}" style="vertical-align:bottom;padding-bottom:3px"></th>
            <th>Message</th>
            <th class="col-xs-2 text-center">Auteur</th>
            <th class="text-center col-xs-1 hidden-xs">Rép.</th>
            <th class="text-center col-xs-1 hidden-xs">Vues</th>
            <th class="text-center col-xs-2">Dernier message</th>
        </tr>
        </thead>
        <tbody>
            {% for thread in object_list %}
            <tr>
                <td class="text-center vert-align" style="padding:0">
                {% if user in thread.contributors.all and thread.posts.latest in user.postsReadCaret.all %}
                    <img src="{% static 'img/added.png' %}" style="vertical-align:middle;padding:0 0 3px 0;">
                {% elif user in thread.contributors.all %}
                    <img src="{% static 'img/added+on.png' %}" style="vertical-align:middle;padding:0 0 3px 0;">
                {% elif thread.posts.latest in user.postsReadCaret.all %}
                    <img src="{% static 'img/off.gif' %}" style="vertical-align:middle;padding:0 0 3px 0;">
                {% else %}
                    <img src="{% static 'img/on.gif' %}" style="vertical-align:middle;padding:0 0 3px 0;">
                {% endif %}
                </td>
                <td class="vert-align">
                    <img src="{% static 'img/icon1.gif' %}" style="vertical-align:bottom;padding-bottom:3px">
                    {% if thread.isSticky and thread.question %}
                        Annonce/Sondage : 
                    {% elif thread.isSticky %}
                        Annonce :
                    {% elif thread.question %}
                        Sondage :
                    {% endif %}
                    <a href="{% url 'forum:thread' category.slug thread.slug %}" style="word-wrap: break-word">{{ thread.title }}</a>
                </td>
                <td class="text-center vert-align importantData">
                    <small><strong>{{ thread.author }}</strong></small>
                </td>
                <td class="text-center vert-align hidden-xs"><small>{{ thread.posts.count|add:"-1" }}</small></td>
                <td class="text-center vert-align hidden-xs"><small>{{ thread.viewCount }}</small></td>
                <td class="text-center vert-align importantData" style="line-height:100%">
                    <small>
                    <a href="{% url 'forum:thread' category.slug thread.slug %}#{{ thread.posts.latest.pk }}" class="lastMessage">
                    {{ thread.modified|date:'d/m/y H:i' }}
                    <br><strong>{{ thread.posts.latest.author }}</strong>
                    </a>
                    </small>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{# Caption #}
<div class="row">
    <div class="col-xs-12">
        <h6>Légende</h6>
    </div>
</div>
<div class="row hidden-sm hidden-xs">  {# Large #}
    <div class="col-md-4">
        <small>Sujets auxquels vous avez participé</small>
        <p class="legend"><img src="{% static 'img/added+on.png' %}" style="vertical-align:middle;padding:0 5px 3px 0;"><small>Des messages non lus depuis votre dernière visite</small></p>
        <p class="legend"><img src="{% static 'img/added.png' %}" style="vertical-align:middle;padding:0 5px 3px 0;"><small>Aucun message non lu depuis votre dernière visite</small></p>
    </div>
    <div class="col-md-4">
        <small>Sujets auxquels vous n'avez pas participé</small>
        <p class="legend"><img src="{% static 'img/on.gif' %}" style="vertical-align:middle;padding:0 5px 3px 0;"><small>Des messages non lus depuis votre dernière visite</small></p>
        <p class="legend"><img src="{% static 'img/off.gif' %}" style="vertical-align:middle;padding:0 5px 3px 0;"><small>Aucun message non lu depuis votre dernière visite</small></p>
    </div>
</div>
<div class="row hidden-lg hidden-md">  {# Small #}
    <div class="col-xs-6">
        <small>Sujets auxquels vous avez participé</small>
        <p class="legend"><img src="{% static 'img/added+on.png' %}" style="vertical-align:middle;padding:0 5px 3px 0;"><small>Des messages non lus depuis votre dernière visite</small></p>
        <p class="legend"><img src="{% static 'img/added.png' %}" style="vertical-align:middle;padding:0 5px 3px 0;"><small>Aucun message non lu depuis votre dernière visite</small></p>
    </div>
    <div class="col-xs-6">
        <small>Sujets auxquels vous n'avez pas participé</small>
        <p class="legend"><img src="{% static 'img/on.gif' %}" style="vertical-align:middle;padding:0 5px 3px 0;"><small>Des messages non lus depuis votre dernière visite</small></p>
        <p class="legend"><img src="{% static 'img/off.gif' %}" style="vertical-align:middle;padding:0 5px 3px 0;"><small>Aucun message non lu depuis votre dernière visite</small></p>
    </div>
</div>
{# Pagination #}
<div class="col-md-12 text-center">
{% if is_paginated %}
<div class="pagination">
    <span class="page-links">
        {% if page_obj.has_previous %}
            <a href="?page=1">&lt;&lt; </a>
            <a href="?page={{ page_obj.previous_page_number }}">Précédente</a>
        {% endif %}
        <span class="page-current">
            Page {{ page_obj.number }} sur {{ page_obj.paginator.num_pages }}
        </span>
        {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}">Suivante</a>
            <a href="?page=last">&gt;&gt;</a>
        {% endif %}
    </span>
</div>
{% endif %}
</div>
{% endblock %}