# upstream socket {
#     server localhost:4000;
# }

server {
    listen 80;
  	listen [::]:80 ipv6only=on;
    server_name ~^(\w+\.)?geekattitude.org;

    access_log /var/log/{{project_name}}/nginx-access.log;
    error_log /var/log/{{project_name}}/nginx-error.log;

    location /static/ {
        alias   {{project_dir}}/naxos/static/;
    }

    location /media/ {
        alias   {{project_dir}}/naxos/media/;
    }

    location / {
        proxy_http_version 1.1;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header Host $http_host;
        proxy_set_header X-NginX-Proxy true;
        proxy_set_header   X-Forwarded-Proto $scheme;
        proxy_redirect off;
        proxy_pass http://127.0.0.1:8000/;  # gunicorn server

        # enable this if and only if you use HTTPS, this helps Rack
        # set the proper protocol for doing redirects:
        # proxy_set_header X-Forwarded-Proto https;

        # # Try to serve static files from nginx, no point in making an
        # # *application* server like Unicorn/Rainbows! serve static files.
        # if (!-f $request_filename) {
        #     proxy_pass http://naxos_app_server;
        #     break;
        # }
    }

    # location /socket.io {
    #     proxy_http_version	1.1;
    #     proxy_set_header	X-Forwarded-For $proxy_add_x_forwarded_for;
    #     proxy_set_header	Host $http_host;
    #     proxy_set_header	Upgrade $http_upgrade;
    #     proxy_set_header	Connection "upgrade";
    #     proxy_redirect		off;
    #     proxy_pass		http://socket;
    # }
}
